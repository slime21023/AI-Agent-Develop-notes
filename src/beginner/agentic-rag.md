# Agentic RAG

## 核心概念

**定義**：一種新興的 AI 範式，其中大型語言模型 (LLM) 不僅從外部數據源檢索資訊，還能**自主地規劃下一步行動**。

**與傳統 RAG 的區別**：
*   **傳統 RAG**：通常遵循靜態的「先檢索、後讀取」(retrieve-then-read) 或預先編排好的提示序列。
*   **Agentic RAG**：涉及對 LLM 的**迭代呼叫**，中間穿插著工具/函數呼叫和結構化輸出。它會評估結果、改進查詢、視需要調用其他工具，並持續此循環直到獲得滿意的解決方案。

**關鍵特徵**：
*   **自主推理 (Owning the Reasoning Process)**：系統能**自主決定**解決問題的方法，而不是依賴預先定義的路徑。它可以根據資訊品質決定步驟順序。
*   **迭代循環 (Iterative Loops)**：依賴「LLM 呼叫 → 工具使用 → LLM 呼叫 → ...」的循環模式。
*   **工具整合 (Tool Integration)**：能動態選擇並使用多種工具（如：向量搜索、SQL 資料庫、自訂 API）。
*   **記憶與狀態 (Memory & State)**：在步驟間維護狀態和記憶，避免重複循環並做出更明智的決策。
*   **自我修正 (Self-Correction)**：當遇到死胡同（如檢索到不相關文件、查詢錯誤）時，能嘗試新策略、重寫查詢或請求人類指導。

## 運作方式

1.  **初始呼叫**：向 LLM 呈現使用者目標（提示）。
2.  **工具調用**：若模型發現資訊缺失或指令模糊，會選擇工具（如向量資料庫查詢、SQL 呼叫）來收集更多上下文。
3.  **評估與改進**：模型審查返回的數據，決定資訊是否足夠。若不足，則改進查詢、嘗試不同工具或調整方法。
4.  **重複直至滿意**：此循環持續進行，直到模型判斷有足夠的清晰度和證據來提供最終、合理的回答。

## 主要優勢與價值

*   **提高正確性**：透過迭代的「製造者-檢查者」(maker-checker) 風格，不斷驗證和精煉，尤其適用於對正確性要求高的環境。
*   **處理複雜互動**：能更好地處理複雜的資料庫查詢（如 NL2SQL），並在查詢失敗時自主修正。
*   **適應性強**：能夠處理需要持續整合新資訊、調整策略的擴展工作流程。
*   **簡化編排**：相較於複雜的編排框架，一個相對簡單的循環就能產生複雜且有根據的輸出。

## 應用場景

*   **正確性優先的環境**：合規性檢查、法規分析、法律研究等，需要反覆驗證事實。
*   **複雜資料庫互動**：需要與結構化數據（如 SQL 資料庫）進行交互，並能自主修正查詢。
*   **擴展工作流程**：需要持續整合新資訊並調整策略的長時間運行任務。

## 限制與邊界

*   **非通用人工智慧 (AGI)**：其自主性**僅限於**開發者提供的工具、數據源和策略範圍內。
*   **領域特定**：專注於在已知領域內實現用戶定義的目標。
*   **依賴基礎設施**：能力取決於整合的工具和數據。
*   **遵守護欄**：必須在道德準則、合規規則和業務策略的約束下運作。

## 治理、透明度與信任

*   **重要性**：隨著系統自主性增強，治理和透明度變得至關重要。
*   **可解釋的推理**：需要提供審計追蹤（查詢記錄、參考來源、推理步驟），可利用 Azure AI Tracing 等工具。
*   **偏見控制**：確保檢索策略平衡、數據來源具代表性，並定期審計輸出。
*   **人類監督**：在高風險決策中，人類審查仍然必不可少。Agentic RAG 是增強而非取代人類判斷。
