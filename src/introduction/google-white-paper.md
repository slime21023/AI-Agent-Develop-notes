# Google AI Agent 白皮書

## 什麼是 AI 代理？

| 概念 | 說明 |
| --- | --- |
| **基本定義** | AI 代理是一個應用程序，透過觀察世界並使用可用工具來達成目標。 |
| **核心特性** | • 自主性：可獨立於人類干預行動<br>• 主動性：能主動實現其目標<br>• 目標導向：嘗試實現特定目標 |
| **核心組成** | 推理能力、邏輯處理與外部資訊訪問的結合，連接至生成式 AI 模型 |

## 代理的基本組件

| 組件 | 功能 | 特點 |
| --- | --- | --- |
| **模型 (Model)** | 中央決策者 | • 可使用任何適合指令推理的語言模型<br>• 支持不同大小和類型 (通用、多模態或微調) <br>• 遵循各種推理框架 (ReAct、CoT等) |
| **工具 (Tools)** | 連接外部世界 | • 彌補模型無法與外部世界互動的限制<br>• 使代理能訪問實時資訊<br>• 三種主要類型：擴展、函數和數據存儲 |
| **協調層 (Orchestration)** | 管理工作流程 | • 控制資訊接收、推理和行動選擇的循環<br>• 複雜度範圍從簡單計算到複雜邏輯<br>• 持續運行直到達成目標或觸發停止條件 |

## 代理與模型的區別

| 特性 | 模型 | 代理 |
| --- | --- | --- |
| **知識範圍** | 僅限訓練數據中的知識 | 透過工具連接外部系統擴展知識 |
| **交互能力** | 單次推理/預測 | 管理會話歷史，支持多輪推理 |
| **工具能力** | 無內置工具實現 | 工具原生整合到架構中 |
| **邏輯處理** | 無原生邏輯層 | 具有原生認知架構 |

## 認知架構：推理框架對比

| 推理框架 | 特點 | 適用場景 |
| --- | --- | --- |
| **ReAct** | • 提供思維過程策略<br>• 結合推理和行動<br>• 增強可解釋性 | • 需要工具使用的任務 <br>• 複雜問題解決<br>• 需要透明決策過程 |
| **思維鏈 (CoT)** | • 通過中間步驟實現推理<br>• 有多種變體 (自一致性、主動提示等) | • 數學問題<br>• 邏輯推理<br>• 分步分析 |
| **思維樹 (ToT)** | • 支持探索多條思路<br>• 允許戰略性展望 | • 戰略決策<br>• 需要評估多個選項<br>• 複雜問題解決 |

## ReAct 框架工作流程

| 步驟 | 動作 | 說明 |
| --- | --- | --- |
| **1** | 接收查詢 | 用戶向代理發送查詢 |
| **2** | 開始 ReAct | 代理初始化 ReAct 序列 |
| **3** | 思考 | 模型思考下一步應該做什麼 |
| **4** | 選擇行動 | 模型決定採取的行動（可能選擇工具） |
| **5** | 提供輸入 | 模型決定提供給工具的輸入參數 |
| **6** | 觀察結果 | 獲取行動/輸入序列的結果 |
| **7** | 重複 3-6 | 根據需要重複思考-行動-觀察循環 |
| **8** | 最終回答 | 提供對原始查詢的最終答案 |

## 三種工具類型對比

| 特性 | 擴展 (Extensions) | 函數 (Functions) | 數據存儲 (Data Stores) |
| --- | --- | --- | --- |
| **執行位置** | 代理端 | 客戶端 | 代理端 |
| **控制方式** | 代理控制 API 互動 | 開發者控制執行 | 代理控制數據檢索 |
| **適用場景** | • 使用預建擴展<br>• 多跳規劃與 API 調用<br>• 需要代理自主決策 | • 安全/認證限制<br>• 時序限制<br>• 需要額外處理<br>• 無法公開訪問的 API | • RAG 應用<br>• 網站內容索引<br>• 結構化/非結構化數據<br>• 實時資訊需求 |
| **實例** | Google Flights、Code Interpreter | 客製化 API 呼叫、交易處理 | 向量數據庫、知識庫、文檔檢索 |

## 提升模型表現的目標學習方法

| 學習方法 | 說明 | 優勢 | 類比 |
| --- | --- | --- | --- |
| **上下文學習**<br>(In-context learning) | 在推理時提供提示、工具和少量示例 | • 快速部署<br>• 無需預訓練<br>• 靈活性高 | 廚師根據食譜和幾種食材即時烹飪 |
| **基於檢索的上下文學習** | 從外部記憶中檢索相關資訊動態填充提示 | • 資訊更完整<br>• 動態適應<br>• 知識更新快 | 廚師從完整廚房選擇最佳食材和食譜 |
| **微調學習** | 使用特定示例的大型數據集訓練模型 | • 性能更穩定<br>• 更深理解<br>• 執行更高效 | 廚師專門學習特定菜系的烹飪技巧 |

## 實作入門：LangChain 示例

```python
from langgraph.prebuilt import create_react_agent
from langchain_core.tools import tool
from langchain_community.utilities import SerpAPIWrapper
from langchain_community.tools import GooglePlacesTool

# 定義搜索工具
@tool
def search(query: str):
    """使用 SerpAPI 執行 Google 搜索"""
    search = SerpAPIWrapper()
    return search.run(query)

# 定義地點工具
@tool
def places(query: str):
    """使用 Google Places API 執行地點查詢"""
    places = GooglePlacesTool()
    return places.run(query)

# 設置模型和工具
model = ChatVertexAI(model="gemini-1.5-flash-001")
tools = [search, places]
query = "德州長角牛隊上週與誰打了足球比賽？對方隊伍的體育場地址是什麼？"

# 創建並執行代理
agent = create_react_agent(model, tools)

```

## 生產應用：Vertex AI 代理

| 組件 | 說明 |
| --- | --- |
| **自然語言介面** | 開發者可透過自然語言定義代理元素 |
| **可定義元素** | • 目標<br>• 任務指令<br>• 工具選擇<br>• 子代理設置<br>• 行為示例 |
| **開發工具** | 測試、評估、績效測量和除錯工具 |
| **優勢** | 開發者可專注於代理設計，平台管理基礎架構 |

## 學習資源

| 主題 | 資源連結 |
| --- | --- |
| **ReAct 框架** | https://arxiv.org/abs/2210.03629 |
| **思維鏈 (CoT)** | https://arxiv.org/pdf/2201.11903.pdf |
| **思維樹 (ToT)** | https://arxiv.org/abs/2305.10601 |
| **LangChain** | https://python.langchain.com/v0.2/docs/introduction/ |
| **ScaNN 搜索算法** | https://github.com/google-research/google-research/tree/master/scann |