# OpenAI Agent指南

## 什麼是 AI 代理？

| 概念 | 說明 |
|------|------|
| 定義 | AI 代理是一種能夠主動、獨立替用戶完成任務的系統，能夠自動處理多步驟工作流程。 |
| 核心能力 | - 利用大型語言模型（LLM）進行推理與決策<br>- 能夠判斷工作流程是否完成，並在必要時自我修正<br>- 遇到問題時能主動停止並將控制權交還給用戶 |
| 與傳統自動化的區別 | 傳統軟體只是協助自動化部分流程，而代理能主動接管整個流程，並根據情境變化做出判斷。 |


## 何時適合建立 AI 代理？

| 適用情境 | 說明 |
|----------|------|
| 複雜決策 | 當工作流程涉及細膩判斷、例外處理或高度依賴上下文，例如客服退款審核。 |
| 規則難以維護 | 當傳統規則引擎過於繁瑣難以維護，例如供應商安全審查。 |
| 處理非結構化資料 | 需要理解自然語言、閱讀文件或進行對話時，例如保險理賠、客訴處理等。 |

**建議**：只有當傳統自動化無法勝任時，才考慮導入代理。


## 代理設計的三大基礎

| 組件 | 說明 | 設計重點 |
|------|------|----------|
| 模型 | LLM 作為代理的「大腦」，負責推理與決策。 | 選擇適合任務複雜度的模型，先用高性能模型建立基準，再考慮用小型模型優化成本。 |
| 工具 | 代理可調用的外部功能或 API，讓代理能與外部系統互動。 | 工具應標準化、文件齊全且可重用，類型可分為數據檢索、行動執行與協調管理。 |
| 指令 | 明確規範代理行為的操作說明與流程指引。 | 指令要具體、結構化，並納入例外處理，減少模糊空間。可參考現有操作手冊、知識庫等。 |

## 工具類型與應用

| 工具類型 | 功能 | 常見應用範例 |
|----------|------|--------------|
| 數據工具 | 取得任務所需的背景資訊或上下文。 | 查詢資料庫、讀取文件、網頁搜尋等。 |
| 行動工具 | 執行對外部系統的操作。 | 發送郵件、更新紀錄、建立訂單等。 |
| 協調工具 | 讓代理本身作為其他代理的工具，實現多代理協作。 | 退款代理、客服代理、寫作代理等。 |

## 指令設計的最佳實踐

| 準則 | 重點說明 |
|------|----------|
| 善用現有文檔 | 直接將操作手冊、流程文件轉化為代理可理解的指令。 |
| 分解任務步驟 | 將複雜任務拆分為明確、易執行的小步驟。 |
| 明確定義行動 | 每個步驟都要明確描述應採取的操作或產生的輸出。 |
| 處理例外情境 | 預先規劃常見的例外狀況，並給出對應處理方式。 |

## 代理協調模式

| 模式 | 說明 | 適用情境 |
|------|------|----------|
| 單代理模式 | 一個代理配備多個工具與明確指令，獨立完成整個工作流程。 | 適合大多數中小型任務，維護簡單。 |
| 多代理模式 | 多個專業代理分工合作，由「管理者代理」協調或彼此交接任務。 | 任務極為複雜、需多領域專長或工具過多時。 |

**設計建議**：能用單一代理解決就不必複雜化，多代理僅在必要時採用。


## 防護機制（Guardrails）設計

| 防護類型 | 功能 | 實施重點 |
|----------|------|----------|
| 相關性分類 | 確保代理回應聚焦於預期主題，過濾離題訊息。 |
| 安全分類 | 偵測越獄、提示注入等攻擊，保障系統安全。 |
| 個資過濾 | 避免代理輸出或處理敏感個人資訊。 |
| 內容審核 | 過濾仇恨、暴力、不當內容，維護品牌形象。 |
| 工具風險分級 | 根據工具風險（如寫入權限、財務影響）設定額外審核或人工介入。 |
| 規則型防護 | 例如黑名單、長度限制、正則過濾等簡單確定性措施。 |
| 輸出驗證 | 確認最終回應符合品牌要求與政策規範。 |

**實施原則**：採用多層次防護，隨著產品演進持續補強，並結合人工審查以因應高風險或不確定情境。

## 開發與部署建議

| 階段 | 建議 |
|------|------|
| 初期設計 | 以單代理模式為主，確保核心功能穩定。 |
| 工具與指令 | 工具標準化、指令結構明確，便於後續擴充。 |
| 模型選擇 | 先用高性能模型建立基準，再視需求優化成本與延遲。 |
| 防護機制 | 先從資料安全與內容安全著手，逐步補強。 |
| 部署策略 | 小規模測試，與真實用戶反覆驗證、逐步擴展。 |
| 迭代優化 | 持續收集用戶反饋，隨需求調整架構與防護機制。 |


> **溫馨提示**：AI 代理的導入是一個循序漸進、持續優化的過程。先確保基礎穩固，再逐步擴展，才能真正發揮其價值。